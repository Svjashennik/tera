<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />

    <title>Формы в React</title>
  </head>

  <body>
    <div id="app"></div>

    <script
      crossorigin
      src="https://unpkg.com/react@16/umd/react.production.min.js"
    ></script>

    <script
      crossorigin
      src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"
    ></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.25.0/babel.min.js"></script>

    <script type="text/babel">
      class NameField extends React.Component {
        constructor(props) {
          super(props); 
          let name = props.name;
          let nameIsValid = this.validateName(name);
          this.state = {
            name: name,
            nameValid: nameIsValid,
          };
          this.onNameChange = this.onNameChange.bind(this);
        }

        validateName(name) {
          return name.length > 2;
        }

        onNameChange(e) {
          let val = e.target.value;
          console.log(val);
          let valid = this.validateName(val);
          this.setState({ name: val, nameValid: valid });
        }
        render() {
          // цвет границы для поля для ввода имени
          let nameColor = this.state.nameValid === true ? "green" : "red";
          return (
            <p>
              <label>Имя:</label>
              <br />
              <input
                type="text"
                value={this.state.name}
                onChange={this.onNameChange}
                style={{ borderColor: nameColor }}
              />
            </p>
          );
        }
      }

      class AgeField extends React.Component {
        constructor(props) {
          super(props);
          let age = props.age;
          let ageIsValid = this.validateAge(age);
          this.state = {
            age: age,
            ageValid: ageIsValid
          };
          this.onAgeChange = this.onAgeChange.bind(this);
        }

        validateAge(age) {
          return age >= 0;
        }

        onAgeChange(e) {
          let val = e.target.value;
          let valid = this.validateAge(val);
          this.setState({ age: val, ageValid: valid });
        }
        render() {
          // цвет границы для поля для ввода возраста
          let ageColor = this.state.ageValid === true ? "green" : "red";

          return (
            <p>
              <label>Возраст:</label>
              <br />

              <input
                type="number"
                value={this.state.age}
                onChange={this.onAgeChange}
                style={{ borderColor: ageColor }}
              />
            </p>
          );
        }
      }

      class UserForm extends React.Component {
        constructor(props) {
          super(props);
          this.handleSubmit = this.handleSubmit.bind(this);
        }

        handleSubmit(e) {
          e.preventDefault();
          let name = this.refs.nameField.state.name;
          let age = this.refs.ageField.state.age;
          if (
            this.refs.nameField.state.nameValid &&
            this.refs.ageField.state.ageValid
          ) {
            alert("Имя: " + name + " Возраст: " + age);
          }
        }
        
        render() {
          return (
            <form onSubmit={this.handleSubmit} style={StyleObj1}>
              <NameField name="" ref="nameField" />
              <AgeField age="5" ref="ageField" />
              <input type="submit" value="Отправить" />
            </form>
          );
        }
      }
      const StyleObj1 = {
            width: "200px",
            height: "150px",
            margin: "20px",
            color: "#666",
        };
      ReactDOM.render(
        <UserForm/>,
        document.getElementById("app")
      );
    </script>
  </body>
</html>
